{{ define "main" }}
  <nav role="navigation" aria-label="Breadcrumbs">
    {{ partial "breadcrumb.html" . }}
  </nav>
  <nav role="navigation" aria-label="Blog postings">
    <ol>
      {{- with .PrevInSection }}
      <li><a id="kdn_p" href="{{ .Permalink }}" rel="prev">Previous post</a></li>
      {{- end }}
      {{- with .NextInSection }}
      <li><a id="kdn_n" href="{{ .Permalink }}" rel="next">Next post</a></li>
      {{- end }}
    </ol>
  </nav>
  <article role="article" aria-labelledby="{{ anchorize .Title }}">
    <header>
      <hgroup>
        <h1 id="{{ anchorize .Title }}">{{ .Title }}</h1>
        {{- with .Params.subtitle }}
        <h2 class="subtitle">{{ . }}</h2>
        {{- end }}
      </hgroup>
    </header>
    <section class="content" role="region" aria-label="article content">
      <a name="skip-to-content" aria-label="Anchor for content"> </a>
      {{ .Content }}
    </section>
    <footer role="complementary">
      <nav aria-label="Metadata related to the article">
        <h2>Metadata</h2>
        <a name="skip-to-posts-metadata" aria-label="Anchor for post's metadata"> </a>
        <dl>
          {{- with .Date }}<dt>Published</dt><dd><time datetime="{{ dateFormat $.Site.Params.iso8601_format . }}">{{ dateFormat "2006-01-02" . }}</time></dd>{{- end }}
          {{ if ne .Lastmod .Date }}
            <dt>Last Modified</dt>
            <dd><time datetime="{{ .Lastmod.Format $.Site.Params.iso8601_format }}">{{ .Lastmod.Format "2006-01-02" }}</time></dd>
          {{ end }}
          {{- with .Params.tags }}
            <dt>Tags<a name="skip-to-tags" aria-label="Anchor for post's tags"></a></dt>
            {{ range . }}
              <dd><a rel="tag" href="{{ "tags" | absURL }}/{{ . | urlize }}" aria-label="All posts with tag {{ . }}">{{ . }}</a></dd>
            {{ end }}
          {{- end }}
          {{- with .PrevInSection }}
            <dt>Previous post</dt>
            <dd>
              <a href="{{ .Permalink }}" rel="prev"><cite>{{ .Title }}</cite></a>
            </dd>
          {{- end }}
          {{- with .NextInSection }}
            <dt>Next post</dt>
            <dd>
              <a href="{{ .Permalink }}" rel="next"><cite>{{ .Title }}</cite></a>
            </dd>
          {{- end }}
          {{- with .Params.series }}
            {{- range (where $.Site.Data.series "key" "eq" .) }}
              {{- $title := .title }}
              <dt>Series</dt>
              <dd><a name='skip-to-series-navigation' href="{{ "series" | absURL }}/{{ .key | urlize }}" rel="bookmark">{{ $title }}</a></dd>
              {{- $series := where $.Site.Pages "Params.series" .key }}
              {{- $prev := where $series ".PublishDate" "lt" $.Page.PublishDate }}
              {{- range first 1 $prev }}
                <dt>Previous in series</dt>
                <dd><a rel="prev" aria-label="Previous {{ $title }} post" href="{{ .Permalink }}">{{ .Title }}</a></dd>
              {{- end}}
              {{- $next := where $series ".PublishDate" "gt" $.Page.PublishDate }}
              {{- range last 1 $next }}
                <dt>Next in series</dt>
                <dd><a rel="next" aria-label="Next {{ $title }} post" href="{{ .Permalink }}">{{ .Title }}</a></dd>
              {{- end}}
            {{- end}}
          {{- end }}
        </dl>
      </nav>
      <nav aria-label="Related articles to post">
        <h2>Related Posts</h2>
        <a name="skip-to-related-posts" aria-label="Anchor for Related Posts"> </a>
        <ul>
          {{ range first 5 (.Site.RegularPages.Related .) }}
            <li>
              <a aria-label="Related post: {{ .Title }}" href="{{ .RelPermalink }}"><cite>{{ .Title | markdownify }}</cite></a>
            </li>
          {{ end }}
        </ul>
      </nav>
    </footer>
  </article>
{{ end }}
