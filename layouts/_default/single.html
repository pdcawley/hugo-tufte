{{ define "breadcrumb" }}
  {{ partial "breadcrumb.html" . }}
{{ end }}
{{ define "main" }}
  <article id="skip-to-content" role="article" aria-labelledby="{{ anchorize .Title }}">
    <header aria-labelledby="{{ anchorize .Title }}" role="heading" aria-level="1">
      <hgroup>
        <h1 id="{{ anchorize .Title }}">{{ .Title }}</h1>
        {{- with .Params.title_sub }}<h2>{{ . }}</h2>{{- end }}
        {{- with .Params.headline }}<h3>{{ . }}</h3>{{- end }}
      </hgroup>
    </header>
    <section class="content" role="region" aria-label="Content">
      {{ .Content }}
    </section>
    <footer role="complementary" aria-label="Metadata and Related Posts">
      <nav aria-labelledby="skip-to-posts-metadata">
        <h2 id="skip-to-posts-metadata">Metadata</h2>
        <p aria-label="Publication date and tags">
        <time aria-label="Published On" datetime="{{ dateFormat $.Site.Params.iso8601_format .Date }}">{{ dateFormat "2006-01-02" .Date }}</time>
        {{ if ne .Lastmod .Date }}<ins>: (Updated <time datetime="{{ .Lastmod.Format $.Site.Params.iso8601_format }}">{{ .Lastmod.Format "2006-01-02" }}</time></ins>){{ end }}
        ::
        {{- with .Params.tags }}<span id="skip-to-tags">{{ partial "tags.html" . }}</span>{{- end }}
        </p>
        {{- with .Params.series }}
          {{- range (where $.Site.Data.series "key" "eq" .) }}
            <p>
              {{- $title := .title }}
              Series: <a name='skip-to-series-navigation' href="{{ "series" | absURL }}/{{ .key | urlize }}" rel="bookmark">{{ $title }}</a>
              {{- $series := where $.Site.Pages "Params.series" .key }}
              {{- $prev := where $series ".PublishDate" "lt" $.Page.PublishDate }}
              {{- range first 1 $prev }}
                : <a rel="prev" title="{{ .Title }}" href="{{ .Permalink }}">previous in series</a>
              {{- end}}
              {{- $next := where $series ".PublishDate" "gt" $.Page.PublishDate }}
              {{- range last 1 $next }}
                : <a rel="next" title="{{ .Title }}" href="{{ .Permalink }}">next in series</a>
              {{- end}}
              </ul>
            </p>
          {{- end}}
        {{- end }}
      </nav>
      <nav aria-labelledby="skip-to-related-posts">
        <h2 id="skip-to-related-posts">Related Posts</h2>
        <ul>
          {{ range first 5 (.Site.RegularPages.Related .) }}
            <li>
              <a aria-label="Related post: {{ .Title }}" href="{{ .RelPermalink }}"><cite>{{ .Title | markdownify }}</cite></a>
            </li>
          {{ end }}
        </ul>
      </nav>
    </footer>
  </article>
{{ end }}
